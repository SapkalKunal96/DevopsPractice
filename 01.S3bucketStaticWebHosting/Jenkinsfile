pipeline {
    agent any

    environment {
        AWS_CREDENTIALS_ID = 'jenkins-aws-key-id'  // The ID of your AWS credentials in Jenkins
        AWS_REGION = 'us-east-1'  // Change to your desired AWS region
        S3_BUCKET = 'www.cloudenthusiastic.online'  // Your S3 bucket name
    }

    stages {
        stage('Code Checkout') {
            steps {
                echo 'Code Checkout....'
                // Checkout code from a private GitHub repository
              //
            }
        }

        stage('Pushing code to S3') {
            steps {
                script {
                    // Set AWS credentials using Jenkins' AWS Credentials plugin
                    withAWS(credentials: AWS_CREDENTIALS_ID, region: AWS_REGION) {
                        // You can use AWS CLI commands after this block
                        try {
                            sh """
                                cd /var/lib/jenkins/workspace/01.S3Bucket/01.S3bucketStaticWebHosting
                                aws s3 sync . s3://${S3_BUCKET}/
                            """
                        } catch (Exception e) {
                            error "AWS S3 sync failed: ${e.getMessage()}"
                        }
                    }
                }
            }
        }

        stage('Deploy') {
            steps {
                echo 'Deploying....'
                // Add your deployment steps here
            }
        }
    }
}
